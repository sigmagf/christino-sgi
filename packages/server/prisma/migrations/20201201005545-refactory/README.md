# Migration `20201201005545-refactory`

This migration has been generated by SigmaGF at 11/30/2020, 9:55:45 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."ReceiptType" AS ENUM ('ORIGINAL', 'XEROX', 'OUTRO', 'BAIXADO')

ALTER TABLE "public"."receipts" DROP COLUMN "status",
ADD COLUMN "status" "ReceiptType"  NOT NULL ,
ALTER COLUMN "issuedOn" DROP NOT NULL

ALTER TABLE "public"."users" DROP COLUMN "newEmail",
DROP COLUMN "newEmailToken",
DROP COLUMN "pwdRstToken",
DROP COLUMN "pwdRstExpires",
DROP COLUMN "newEmailExpires"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201201004346-rebuilding-database..20201201005545-refactory
--- datamodel.dml
+++ datamodel.dml
@@ -3,23 +3,25 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
+enum ReceiptType {
+  ORIGINAL
+  XEROX
+  OUTRO
+  BAIXADO
+}
+
 model User {
-  id              String    @id @default(uuid())
-  name            String
-  email           String    @unique
-  password        String
-  newEmail        String?
-  newEmailToken   String?
-  newEmailExpires DateTime?
-  pwdRstToken     String?
-  pwdRstExpires   DateTime?
-  createdAt       DateTime  @default(now())
-  updatedAt       DateTime  @default(now()) @updatedAt
+  id        String   @id @default(uuid())
+  name      String
+  email     String   @unique
+  password  String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now()) @updatedAt
   @@map("users")
 }
@@ -53,15 +55,15 @@
 model Receipt {
   clientId  String
   vehicleId String
   details   String?
-  status    String
-  issuedOn  DateTime
-  createdAt DateTime  @default(now())
-  updatedAt DateTime  @default(now()) @updatedAt
+  status    ReceiptType
+  issuedOn  DateTime?
+  createdAt DateTime    @default(now())
+  updatedAt DateTime    @default(now()) @updatedAt
-  client    Client    @relation("receipt-client", fields: [clientId], references: [id])
-  vehicle   Vehicle   @relation("receipt-vehicle", fields: [vehicleId], references: [id])
+  client    Client      @relation("receipt-client", fields: [clientId], references: [id])
+  vehicle   Vehicle     @relation("receipt-vehicle", fields: [vehicleId], references: [id])
+  @@id([clientId, vehicleId])
   @@map("receipts")
-  @@id([clientId, vehicleId])
 }
```


